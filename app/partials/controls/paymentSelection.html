<div class="animated fadeInDown">
    <h5><label>Payment Method</label></h5>
    <span class="btn-group">
        <button class="btn btn-default" ng-show="user.Permissions.contains('PayByPO')" ng-click="currentOrder.PaymentMethod = 'PurchaseOrder'">
            <i ng-class="{'fa fa-check': currentOrder.PaymentMethod == 'PurchaseOrder' }"></i>
            Purchase Order
        </button>
        <button class="btn btn-default" ng-show="user.Permissions.contains('SubmitForApproval') && currentOrder.Approvals" ng-click="currentOrder.PaymentMethod = 'Undetermined'">
            <i ng-class="{'fa fa-check': currentOrder.PaymentMethod == 'Undetermined' }"></i>
            Approval Order
        </button>
        <button ng-if="user.Permissions.contains('PayByBudgetAccount') && (SpendingAccounts|filter:{AccountType.PurchaseCredit:true}).length > 0" class="btn btn-default" ng-click="currentOrder.PaymentMethod = 'BudgetAccount'">
            <i ng-class="{'fa fa-check': currentOrder.PaymentMethod == 'BudgetAccount' }"></i>
            Spending Account {{showSpendingAccount}}
        </button>
        <button ng-if="user.Company.MerchantAccount && user.AvailableCreditCards.length > 0 && user.Permissions.contains('PayByCreditCard')" class="btn btn-default" ng-click="currentOrder.PaymentMethod = 'CreditCard'">
            <i ng-class="{'fa fa-check': currentOrder.PaymentMethod == 'CreditCard' }"></i>
            Credit Card
        </button>
    </span>
    <div ng-if="user.Permissions.contains('PayByBudgetAccount')" ng-show="currentOrder.PaymentMethod == 'BudgetAccount'">
        <span ng-show="(SpendingAccounts|filter:{AccountType.PurchaseCredit:true}).length == 1">{{SpendingAccounts[0].Label + ' - Balance: ' + (SpendingAccounts[0].Balance | currency)}}</span>
        <select ng-show="(SpendingAccounts|filter:{AccountType.PurchaseCredit:true}).length > 1"
                ng-options="account.ID as (account.Label + ' - Balance: ' + (account.Balance | currency)) for account in SpendingAccounts | filter:{AccountType.PurchaseCredit:true}"
                ng-model="currentOrder.BudgetAccountID"
                ng-required="currentOrder.PaymentMethod == 'BudgetAccount'"></select>
        <br /><span class="alert alert-warning" ng-show="cart_billing.$error.paymentMethod">The order total is not covered by the selected account.</span>
    </div>
    <hr />
    <div ng-if="user.Permissions.contains('PayByCreditCard')" ng-show="currentOrder.PaymentMethod == 'CreditCard'">
        <label>Type</label><select ng-model="currentOrder.CreditCard.Type" ng-options="creditCard.DisplayName as creditCard.Type for creditCard in user.AvailableCreditCards"></select>
        <label ng-if="user.Permissions.contains('CardholderName')">Cardholder Name</label><input ng-if="user.Permissions.contains('CardholderName')" ng-model="currentOrder.CreditCard.CardholderName" ng-required="currentOrder.PaymentMethod == 'CreditCard'" type="text" placeholder="Cardholder Name" />
        <label>Account Number</label><input ng-model="currentOrder.CreditCard.AccountNumber" ng-required="currentOrder.PaymentMethod == 'CreditCard'" type="text" autocomplete="false" placeholder="Account Number" />
        <label>Expiration Date (mm/yy)</label><input ng-model="currentOrder.CreditCard.ExpirationDate" ng-required="currentOrder.PaymentMethod == 'CreditCard'" type="text" ui-mask="99/99" placeholder="Expiration Date" />
        <label ng-if="currentOrder.RequireCVN">CVN</label><input ng-model="currentOrder.CreditCard.CVN" ng-required="currentOrder.PaymentMethod == 'CreditCard'" ng-if="currentOrder.RequireCVN" type="text" placeholder="Card Identification Number" maxlength="4" />
        <span ng-if="user.Permissions.contains('AllowSaveCreditCard')">
            <input ng-model="currentOrder.CreditCard.Save"  type="checkbox" /><label>Save my credit card information</label>
        </span>
    </div>
</div>
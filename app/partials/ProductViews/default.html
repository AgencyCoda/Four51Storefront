<section id="451_area_prod_desc" class="container product-view-default">
    <loadingindicator ng-show="loadingIndicator" title="Please wait while we fetch product information" />
    <productnav product="LineItem.Product" variant="LineItem.Variant" />
    <div class="row">
        <div class="col-sm-5 col-collapse" ng-show="LineItem.Variant.LargeImageFile.Url || LineItem.Product.LargeImageFile.Url || LineItem.Variant.PreviewUrl">
            <figure style="background-color:#fff;">
                <img id="451_img_prod_lg" ng-src="{{LineItem.Variant.PreviewUrl || LineItem.Variant.LargeImageFile.Url || LineItem.Product.LargeImageFile.Url}}">
            </figure>
        </div>

        <div class="col-sm-6 col-sm-offset-1 col-collapse" ng-show="allowAddToOrder">
            <!--BASIC PRODUCT INFO!-->
            <h4 ng-show="LineItem.Product.ExternalID" class="pull-right text-info">ID: {{LineItem.Product.ExternalID}}</h4>
            <h2 ng-hide="LineItem.Variant.ExternalID">{{LineItem.Product.Name}}</h2>
            <h2 ng-show="LineItem.Variant.ExternalID">{{LineItem.Variant.ExternalID}}</h2>
            <div ng-show="LineItem.Product.Description">

            <!--PRODUCT DESCRIPTION PANEL!--->
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title panel-primary">
                            Description
                        </h3>
                    </div>
                    <div class="panel-body">
                        <p ng-bind-html="LineItem.Product.Description" />
                        <p ng-bind-html="LineItem.Variant.Description" />
                    </div>
                </div>
            </div>

            <!--STATIC SPECS PANEL!-->
            <staticspecstable ng-show="StaticSpecGroups && user.Permissions.contains('ViewNonCustomizableSpecs')" specgroups="StaticSpecGroups"/>

            <!--VARIANT LIST TABLE!-->
            <form name="addToOrderForm">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <h3 class="panel-title">
                        Order
                    </h3>
                </div>
                <div class="panel-body">
                    <div ng-if="LineItem.Product.Variants.length > 0 && !LineItem.Variant">
                        <h4 class="text-center">Choose a variant:</h4>
                        <div class="row" ng-repeat="v in LineItem.Product.Variants">
                            <a href=#/product/{{LineItem.Product.ViewName}}/{{LineItem.Product.InteropID}}/{{v.InteropID}} class="text-info">{{v.ExternalID}}</a>
                            <div class="pull-right" ng-if="allowAddFromVariantList">
                                <quantityfield calculated="calcVariantLineItems" lineitem="variantLineItems[v.InteropID]" error="quantityError" class="quantity" /> {{quantityError}} {{variantLineItems[v.InteropID].LineTotal | currency}}
                            </div>
                            <div ng-show="LineItem.Product.DisplayInventory && LineItem.Product.IsVariantLevelInventory">
                                <div ng-show="LineItem.Product.DisplayInventory && LineItem.Product.IsVariantLevelInventory">
                                    {{v.QuantityAvailable + ' in stock'}}
                                </div>
                            </div>
                            <div ng-show="v.Description">
                                <div>
                                    {{v.Description}}
                                </div>
                            </div>
                        </div>
                    </div>

                    <p ng-show="LineItem.Product.DisplayInventory && inventoryDisplay(LineItem.Product, LineItem.Variant)">
                        <!-- nothing is accomodating the 0 level inventory and the custom message to be displayed -->
                        {{inventoryDisplay(LineItem.Product, LineItem.Variant) + ' in stock'}}
                    </p>
                    <br/>
                    <div id="451_list_vspec" ng-show="allowAddToOrder">
                        <div class="row" ng-repeat="s in LineItem.Specs | onproperty:[{Property: 'CanSetForLineItem', Value: true}, {Property: 'DefinesVariant', Value: true}]">
                                <label>{{s.Name}}</label>{{s.Prefix}}
                                <customfilefield customfield="s" ng-if="s.ControlType == 'File'"></customfilefield>
                                <customtextfield customfield="s" ng-if="s.ControlType == 'Text'"></customtextfield>
                                <customselectionfield change="specChanged" customfield="s" ng-if="s.ControlType == 'Selection'"></customselectionfield>
                                {{s.Suffix}}
                        </div>
                    </div>

                    <div style="float: left;">
                        <span class="text-info" ng-hide="allowAddFromVariantList">Order Quantity:</span>
                        <quantityfield ng-if="!allowAddFromVariantList" required="true" lineitem="LineItem" error="quantityError" class="quantity" />
                    </div>

                    <p class="alert alert-danger" ng-show="quantityError">
                        {{quantityError}}
                    </p>
                    <p class="alert alert-danger" ng-show="LineItem.PriceSchedule.MinQuantity > 1">
                        Minimum Quantity: {{LineItem.PriceSchedule.MinQuantity}}
                    </p>
                    <p class="alert alert-danger" ng-show="LineItem.PriceSchedule.MaxQuantity">
                        Maximum Quantity: {{LineItem.PriceSchedule.MaxQuantity}}
                    </p>
                    <p class="alert alert-warning" ng-show="addToOrderForm.$invalid" >
                        Product is missing required fields for Add to Cart.
                    </p>

                </div>
                <div class="panel-footer">
                    <div ng-hide="LineItem.LineTotal || variantLineItemsOrderTotal" class="col-md-3"></div>
                    <div ng-show="LineItem.LineTotal || variantLineItemsOrderTotal" class="col-md-6 text-center">
                        <h3 style="margin-top:0; display:inline-block;">Total:</h3 >
                        <h3 class="text-success" style="margin:0; padding:0; display:inline-block;">
                            {{LineItem.LineTotal | currency}}{{variantLineItemsOrderTotal | currency}}
                        </h3>
                    </div>
                    <div class="col-md-6">
                        <button type="button" id="451_btn_orderadd" ng-disabled="addToOrderForm.$invalid" ng-click="addToOrder(LineItem)" class="btn btn-primary btn-block btn-lg">
                            {{addToOrderText}}
                        </button>
                    </div>
                </div>
            </div>
            </form>


            <!--EDIT / VIEW VARIANT
            <span ng-show="LineItem.Product.Type=='VariableText' && LineItem.Variant">
                <button class="btn btn-xs btn-warning" redirect="/product/{{LineItem.Product.ViewName}}/{{LineItem.Product.InteropID}}/{{LineItem.Variant.InteropID}}/edit">Edit</button>
                <button class="btn btn-xs btn-warning" redirect="{{LineItem.Variant.ProofUrl}}">View PDF</button>
            </span>!-->

            <!--PRODUCT INVENTORY
            <div ng-show="inventoryDisplay(LineItem.Product, LineItem.Variant)">
                <hr />
                <p>
                    <span class="text-info">Available Inventory:</span> {{inventoryDisplay(LineItem.Product, LineItem.Variant) }}
                </p>
            </div>!-->


            <!--CREATE NEW VARIANT
            <div ng-show="LineItem.Product.Type == 'VariableText'">
                <button type="button" ng-show="!LineItem.Variant" class="btn btn-xs btn-danger" redirect="/product/{{LineItem.Product.ViewName}}/{{LineItem.Product.InteropID}}/new/edit" tabindex="-1">Create New</button>
            </div>!-->

        </div>
    </div>

</section>